I"g‘<p>ë°ì´í„°ë² ì´ìŠ¤ COSE 371(2) 4ì£¼ì°¨ ê°•ì˜ë‚´ìš© ì¤‘ IN VS EXISTSì— ëŒ€í•œ ë³´ì¶© ì„¤ëª…ì…ë‹ˆë‹¤.</p>

<h2 id="lecture-note">Lecture Note</h2>

<div class="slide">
<iframe src="https://onedrive.live.com/embed?cid=7230FE4126F9D3CC&amp;resid=7230FE4126F9D3CC%214572&amp;authkey=AJdKTcISeaiIV-s&amp;em=2&amp;wdAr=1.7777777777777777" frameborder="0">í¬í•¨ëœ <a target="_blank" href="https://office.com">Microsoft Office</a> í”„ë ˆì  í…Œì´ì…˜, ì œê³µ: <a target="_blank" href="https://office.com/webapps">Office Online</a></iframe>
</div>

<hr />

<h3 id="1-í•„ìš”ì„±">1. í•„ìš”ì„±?</h3>

<hr />

<ul>
  <li>ë‘ êµ¬ë¬¸ ëª¨ë‘ SQLì˜ í‘œí˜„ë ¥ì„ ë†’ì—¬ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.
    <ul>
      <li>íŠ¹íˆ MySQLì´ë‚˜ ë‚®ì€ ë²„ì „ì˜ MariaDBì—ì„œëŠ” INTERSECT ê¸°ëŠ¥ì´ë‚˜ EXCEPT ê¸°ëŠ¥ì´ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ ê²½ìš° IN ë˜ëŠ” EXISTS êµ¬ë¬¸ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ =&gt; Q4 ì°¸ì¡°.</li>
    </ul>
  </li>
  <li>ì°¨ì´ì ?
    <ul>
      <li>INì˜ ê²½ìš° ê°’ì˜ ì¡´ì¬ì„±ì„ ê²€ì‚¬í•  ë•Œ ì‚¬ìš©í•˜ë©°, EXISTSì˜ ê²½ìš° TUPLEì˜ ì¡´ì¬ì„±ì„ ê²€ì‚¬í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
      <li>NULLê³¼ ê´€ë ¨ëœ ì´ìŠˆì— ìˆì–´ì„œë„ ë‘ êµ¬ë¬¸ì´ ì°¨ì´ë‚©ë‹ˆë‹¤.</li>
      <li>ë‹¤ìŒê³¼ ê°™ì€ ê°„ëµí•œ constant value setì— ëŒ€í•œ ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•  ë•Œ INì„ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
    </ul>
  </li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">N_NATIONKEY</span><span class="p">,</span> <span class="n">N_NAME</span><span class="p">,</span> <span class="n">N_REGIONKEY</span> 
    <span class="o">-&gt;</span>                    <span class="k">FROM</span> <span class="n">NATION</span> 
    <span class="o">-&gt;</span>                    <span class="k">WHERE</span> <span class="n">N_NAME</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'U.S.A.'</span><span class="p">,</span> <span class="s1">'USA'</span><span class="p">,</span> <span class="s1">'UNITED STATES'</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------+---------------+-------------+</span>
<span class="o">|</span> <span class="n">N_NATIONKEY</span> <span class="o">|</span> <span class="n">N_NAME</span>        <span class="o">|</span> <span class="n">N_REGIONKEY</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+---------------+-------------+</span>
<span class="o">|</span>          <span class="mi">24</span> <span class="o">|</span> <span class="n">UNITED</span> <span class="n">STATES</span> <span class="o">|</span>           <span class="mi">1</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+---------------+-------------+</span>
</code></pre></div></div>

<h3 id="2-correlated">2. Correlated?</h3>

<hr />

<ul>
  <li>
    <p>INì€ correlated subquery í˜•íƒœë¡œ ì‚¬ìš©ë  ìˆ˜ë„ ìˆê³ , correlated subquery í˜•íƒœë¡œ ì‚¬ìš©ë˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>
  </li>
  <li>
    <p>ë°˜ë©´ <strong>EXISTS êµ¬ë¶„ì€ ì¼ë°˜ì ìœ¼ë¡œ correlated subqueryë¡œ ì‚¬ìš©</strong>ë©ë‹ˆë‹¤. correlatedê°€ ì•„ë‹Œ EXISTS êµ¬ë¬¸ì€ ë³„ ì˜ë¯¸ê°€ ì—†ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì•„ë˜ ì˜ˆì œì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ correlated ë˜ì–´ìˆì§€ ì•Šì€ EXISTS êµ¬ë¬¸ì´ subqueryì— ëŒ€í•´ í•­ìƒ FALSE ë‚˜ TRUEë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</p>
  </li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">-- Correlated Subqueryê°€ ì•„ë‹Œ EXISTS êµ¬ë¬¸ --</span>
<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span>
<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span>
<span class="o">-&gt;</span>         <span class="k">FROM</span> <span class="n">CUSTOMER</span> <span class="k">WHERE</span> <span class="n">C_ADDRESS</span> <span class="k">LIKE</span> <span class="s1">'%abc%'</span> <span class="k">AND</span>
<span class="o">-&gt;</span>              <span class="c1">------------ which is always true ------------</span>
<span class="o">-&gt;</span>              <span class="k">EXISTS</span>
<span class="o">-&gt;</span>              <span class="p">(</span><span class="k">SELECT</span> <span class="n">O_CustKey</span>
<span class="o">-&gt;</span>                      <span class="k">FROM</span> <span class="n">ORDERS</span>
<span class="o">-&gt;</span>                      <span class="k">WHERE</span> <span class="k">LOWER</span><span class="p">(</span><span class="n">O_COMMENT</span><span class="p">)</span> <span class="k">LIKE</span> <span class="s1">'%quickly%'</span>
<span class="o">-&gt;</span>              <span class="p">)</span>
<span class="o">-&gt;</span>              <span class="c1">------------ which is always true ------------</span>
<span class="o">-&gt;</span>              <span class="p">;</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span>                     <span class="mi">99</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="mi">1</span> <span class="k">row</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">09</span> <span class="n">sec</span><span class="p">)</span>

<span class="c1">-- ìœ„ì—ì„œ EXISTS êµ¬ë¬¸ì„ ì œì™¸ì‹œí‚´ --</span>
<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span>
<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span>
    <span class="o">-&gt;</span> <span class="k">FROM</span> <span class="n">CUSTOMER</span> <span class="k">WHERE</span> <span class="n">C_ADDRESS</span> <span class="k">LIKE</span> <span class="s1">'%abc%'</span> <span class="k">AND</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span>                     <span class="mi">99</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="mi">1</span> <span class="k">row</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">09</span> <span class="n">sec</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="3-in---exists">3. IN &lt;-&gt; EXISTS</h3>

<hr />

<ul>
  <li>ë§ì€ ê²½ìš° non-correlated IN êµ¬ë¬¸ì€ correlated EXISTSêµ¬ë¬¸ìœ¼ë¡œ, correlated EXISTS êµ¬ë¬¸ì€ non-correlated IN êµ¬ë¬¸ìœ¼ë¡œ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    <ul>
      <li><a href="https://stackoverflow.com/questions/31297417/how-to-replace-the-in-operator-with-exists-operator-for-the-where-clause-part-o">IN &lt;-&gt; EXISTS</a></li>
    </ul>
  </li>
</ul>

<h3 id="4-performance-optimizer-disabled">4. Performance (optimizer disabled)</h3>

<ul>
  <li>(DBMSì˜ Optimizerê°€ ê°œì…í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê°€ì •í•˜ì—) INê³¼ EXISTSëŠ” ìƒí™©ì— ë”°ë¼ ë‹¤ë¥¸ ì„±ëŠ¥ì„ ë³´ì…ë‹ˆë‹¤.</li>
  <li>ì•„ë˜ ì˜ˆì œëŠ” correlated EXISTS êµ¬ë¬¸ì´ non-correlated IN êµ¬ë¬¸ ë³´ë‹¤ 30ë°° ê°€ëŸ‰ ë¹ ë¥¸ ì˜ˆì œì…ë‹ˆë‹¤.</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">-- í˜„ì¬ Sessionì— í•œí•´ EXISTS-TO-IN Optimization Ruleì„ ì ìš©í•˜ì§€ ì•ŠìŒ --</span>

<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">SET</span> <span class="k">SESSION</span> <span class="n">optimizer_switch</span><span class="o">=</span><span class="s1">'exists_to_in=off'</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="k">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>

<span class="c1">-- Correlated EXISTS =&gt; 35.26ì´ˆ --</span>

<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span>
    <span class="o">-&gt;</span>         <span class="k">FROM</span> <span class="n">CUSTOMER</span> <span class="k">WHERE</span> <span class="n">C_ADDRESS</span> <span class="k">LIKE</span> <span class="s1">'%abc%'</span> <span class="k">AND</span>
    <span class="o">-&gt;</span>         <span class="k">EXISTS</span>
    <span class="o">-&gt;</span>         <span class="p">(</span><span class="k">SELECT</span> <span class="n">O_CustKey</span>
    <span class="o">-&gt;</span>                 <span class="k">FROM</span> <span class="n">ORDERS</span>
    <span class="o">-&gt;</span>                 <span class="k">WHERE</span> <span class="n">O_custKey</span> <span class="o">=</span> <span class="n">C_CustKey</span> <span class="k">AND</span> <span class="k">LOWER</span><span class="p">(</span><span class="n">O_COMMENT</span><span class="p">)</span> <span class="k">LIKE</span> <span class="s1">'%quickly%'</span>
    <span class="o">-&gt;</span>         <span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span>                     <span class="mi">62</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="mi">1</span> <span class="k">row</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">35</span><span class="p">.</span><span class="mi">26</span> <span class="n">sec</span><span class="p">)</span>

<span class="c1">-- Non-correlated IN =&gt; 1.69ì´ˆ --</span>

<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span>
    <span class="o">-&gt;</span>  <span class="k">FROM</span> <span class="n">CUSTOMER</span> <span class="k">WHERE</span> <span class="n">C_ADDRESS</span> <span class="k">LIKE</span> <span class="s1">'%abc%'</span> <span class="k">AND</span>
    <span class="o">-&gt;</span>  <span class="n">C_CustKey</span> <span class="k">IN</span>
    <span class="o">-&gt;</span>  <span class="p">(</span><span class="k">SELECT</span> <span class="n">O_CustKey</span>
    <span class="o">-&gt;</span>          <span class="k">FROM</span> <span class="n">ORDERS</span>
    <span class="o">-&gt;</span>          <span class="k">WHERE</span> <span class="k">LOWER</span><span class="p">(</span><span class="n">O_COMMENT</span><span class="p">)</span> <span class="k">LIKE</span> <span class="s1">'%quickly%'</span>
    <span class="o">-&gt;</span>  <span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span>                     <span class="mi">62</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="mi">1</span> <span class="k">row</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">69</span> <span class="n">sec</span><span class="p">)</span>


</code></pre></div></div>

<ul>
  <li>ìœ„ Queryë¥¼ ì²˜ë¦¬í•  ë•Œ DBMSê°€ ì–´ë–¤ Planì„ ì‚¬ìš©í–ˆëŠ”ì§€ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">-- Correlated EXISTS =&gt; DEPENDENT SUBQUERY ê¸°ë°˜ --</span>

<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">EXPLAIN</span>
    <span class="o">-&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span>
    <span class="o">-&gt;</span> <span class="k">FROM</span> <span class="n">CUSTOMER</span> <span class="k">WHERE</span> <span class="n">C_ADDRESS</span> <span class="k">LIKE</span> <span class="s1">'%abc%'</span> <span class="k">AND</span>
    <span class="o">-&gt;</span> <span class="k">EXISTS</span>
    <span class="o">-&gt;</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">O_CustKey</span>
    <span class="o">-&gt;</span>         <span class="k">FROM</span> <span class="n">ORDERS</span>
    <span class="o">-&gt;</span>         <span class="k">WHERE</span> <span class="n">O_custKey</span> <span class="o">=</span> <span class="n">C_CustKey</span> <span class="k">AND</span> <span class="k">LOWER</span><span class="p">(</span><span class="n">O_COMMENT</span><span class="p">)</span> <span class="k">LIKE</span> <span class="s1">'%quickly%'</span>
    <span class="o">-&gt;</span> <span class="p">);</span>
<span class="o">+</span><span class="c1">------+--------------------+----------+------+---------------+------+---------+------+---------+-------------+</span>
<span class="o">|</span> <span class="n">id</span>   <span class="o">|</span> <span class="n">select_type</span>        <span class="o">|</span> <span class="k">table</span>    <span class="o">|</span> <span class="k">type</span> <span class="o">|</span> <span class="n">possible_keys</span> <span class="o">|</span> <span class="k">key</span>  <span class="o">|</span> <span class="n">key_len</span> <span class="o">|</span> <span class="k">ref</span>  <span class="o">|</span> <span class="k">rows</span>    <span class="o">|</span> <span class="n">Extra</span>       <span class="o">|</span>
<span class="o">+</span><span class="c1">------+--------------------+----------+------+---------------+------+---------+------+---------+-------------+</span>
<span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span> <span class="k">PRIMARY</span>            <span class="o">|</span> <span class="n">CUSTOMER</span> <span class="o">|</span> <span class="k">ALL</span>  <span class="o">|</span> <span class="k">NULL</span>          <span class="o">|</span> <span class="k">NULL</span> <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span> <span class="k">NULL</span> <span class="o">|</span>  <span class="mi">147940</span> <span class="o">|</span> <span class="k">Using</span> <span class="k">where</span> <span class="o">|</span>
<span class="o">|</span>    <span class="mi">2</span> <span class="o">|</span> <span class="n">DEPENDENT</span> <span class="n">SUBQUERY</span> <span class="o">|</span> <span class="n">ORDERS</span>   <span class="o">|</span> <span class="k">ALL</span>  <span class="o">|</span> <span class="k">NULL</span>          <span class="o">|</span> <span class="k">NULL</span> <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span> <span class="k">NULL</span> <span class="o">|</span> <span class="mi">1481240</span> <span class="o">|</span> <span class="k">Using</span> <span class="k">where</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------+--------------------+----------+------+---------------+------+---------+------+---------+-------------+</span>
<span class="mi">2</span> <span class="k">rows</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>

<span class="c1">-- Non-correlated IN =&gt; MATERIALIZED ê¸°ë°˜ --</span>

<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span>
<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">EXPLAIN</span>
    <span class="o">-&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span>
    <span class="o">-&gt;</span> <span class="k">FROM</span> <span class="n">CUSTOMER</span> <span class="k">WHERE</span> <span class="n">C_ADDRESS</span> <span class="k">LIKE</span> <span class="s1">'%abc%'</span> <span class="k">AND</span>
    <span class="o">-&gt;</span> <span class="n">C_CustKey</span> <span class="k">IN</span>
    <span class="o">-&gt;</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">O_CustKey</span>
    <span class="o">-&gt;</span>  <span class="k">FROM</span> <span class="n">ORDERS</span>
    <span class="o">-&gt;</span>  <span class="k">WHERE</span> <span class="k">LOWER</span><span class="p">(</span><span class="n">O_COMMENT</span><span class="p">)</span> <span class="k">LIKE</span> <span class="s1">'%quickly%'</span>
    <span class="o">-&gt;</span> <span class="p">);</span>
<span class="o">+</span><span class="c1">------+--------------+-------------+--------+---------------+--------------+---------+------+---------+-------------+</span>
<span class="o">|</span> <span class="n">id</span>   <span class="o">|</span> <span class="n">select_type</span>  <span class="o">|</span> <span class="k">table</span>       <span class="o">|</span> <span class="k">type</span>   <span class="o">|</span> <span class="n">possible_keys</span> <span class="o">|</span> <span class="k">key</span>          <span class="o">|</span> <span class="n">key_len</span> <span class="o">|</span> <span class="k">ref</span>  <span class="o">|</span> <span class="k">rows</span>    <span class="o">|</span> <span class="n">Extra</span>       <span class="o">|</span>
<span class="o">+</span><span class="c1">------+--------------+-------------+--------+---------------+--------------+---------+------+---------+-------------+</span>
<span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span> <span class="k">PRIMARY</span>      <span class="o">|</span> <span class="n">CUSTOMER</span>    <span class="o">|</span> <span class="k">ALL</span>    <span class="o">|</span> <span class="k">PRIMARY</span>       <span class="o">|</span> <span class="k">NULL</span>         <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span> <span class="k">NULL</span> <span class="o">|</span>  <span class="mi">147940</span> <span class="o">|</span> <span class="k">Using</span> <span class="k">where</span> <span class="o">|</span>
<span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span> <span class="k">PRIMARY</span>      <span class="o">|</span> <span class="o">&lt;</span><span class="n">subquery2</span><span class="o">&gt;</span> <span class="o">|</span> <span class="n">eq_ref</span> <span class="o">|</span> <span class="n">distinct_key</span>  <span class="o">|</span> <span class="n">distinct_key</span> <span class="o">|</span> <span class="mi">4</span>       <span class="o">|</span> <span class="n">func</span> <span class="o">|</span>       <span class="mi">1</span> <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>    <span class="mi">2</span> <span class="o">|</span> <span class="n">MATERIALIZED</span> <span class="o">|</span> <span class="n">ORDERS</span>      <span class="o">|</span> <span class="k">ALL</span>    <span class="o">|</span> <span class="k">NULL</span>          <span class="o">|</span> <span class="k">NULL</span>         <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span> <span class="k">NULL</span> <span class="o">|</span> <span class="mi">1481240</span> <span class="o">|</span> <span class="k">Using</span> <span class="k">where</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------+--------------+-------------+--------+---------------+--------------+---------+------+---------+-------------+</span>
<span class="mi">3</span> <span class="k">rows</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="5-performance-optimizer-enabled">5. Performance (optimizer enabled)</h3>

<hr />

<ul>
  <li>ìƒìš© DBMSëŠ” í•„ìš”ì— ë”°ë¼ INì„ ë™ë“±í•œ EXISTSë¡œ, ë˜ëŠ” EXISTSë¥¼ ë™ë“±í•œ INìœ¼ë¡œ ë°”ê¾¸ì–´ ì²˜ë¦¬í•˜ëŠ” ìµœì í™” ê³¼ì •ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.
    <ul>
      <li><a href="https://mariadb.com/kb/en/library/exists-to-in-optimization/">EXISTS-TO-IN (MariaDB)</a></li>
      <li><a href="https://mariadb.com/kb/en/non-semi-join-subquery-optimizations/#the-in-to-exists-transformation">IN-TO-EXISTS (MariaDB)</a></li>
    </ul>
  </li>
  <li>ê·¸ëŸ¬ë‚˜ DBMSì— ì „ì ìœ¼ë¡œ ì„±ëŠ¥ ìµœì í™”ë¥¼ ë§¡ê¸°ëŠ” ê²ƒì€ ë°”ëŒì§í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    <ul>
      <li>ì‚¬ìš©í•˜ëŠ” DBMSì—ì„œ ì œê³µí•˜ëŠ” ë¬¸ì„œë¥¼ ì˜ ì½ì–´ë³´ì‹œê³  ë‹¤ì–‘í•˜ê²Œ ë³€í˜• ì§ˆì˜ë¬¸ì„ ì‹¤í—˜í•´ë´„ìœ¼ë¡œì¨ ìµœì í™”ëœ ì§ˆì˜ë¬¸ì„ ì°¾ìœ¼ì‹œëŠ” ê²ƒì´ ë°”ëŒì§í•©ë‹ˆë‹¤.</li>
    </ul>
  </li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">-- Correlated EXISTS =&gt; 1.69ì´ˆ --</span>

<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span>
    <span class="o">-&gt;</span> <span class="k">FROM</span> <span class="n">CUSTOMER</span> <span class="k">WHERE</span> <span class="n">C_ADDRESS</span> <span class="k">LIKE</span> <span class="s1">'%abc%'</span> <span class="k">AND</span>
    <span class="o">-&gt;</span> <span class="k">EXISTS</span>
    <span class="o">-&gt;</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">O_CustKey</span>
    <span class="o">-&gt;</span>         <span class="k">FROM</span> <span class="n">ORDERS</span>
    <span class="o">-&gt;</span>         <span class="k">WHERE</span> <span class="n">O_custKey</span> <span class="o">=</span> <span class="n">C_CustKey</span> <span class="k">AND</span> <span class="k">LOWER</span><span class="p">(</span><span class="n">O_COMMENT</span><span class="p">)</span> <span class="k">LIKE</span> <span class="s1">'%quickly%'</span>
    <span class="o">-&gt;</span> <span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span>                     <span class="mi">62</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="mi">1</span> <span class="k">row</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">69</span> <span class="n">sec</span><span class="p">)</span>

<span class="c1">-- Non-correlated IN =&gt; 1.80ì´ˆ --</span>

<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span>
<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span>
    <span class="o">-&gt;</span> <span class="k">FROM</span> <span class="n">CUSTOMER</span> <span class="k">WHERE</span> <span class="n">C_ADDRESS</span> <span class="k">LIKE</span> <span class="s1">'%abc%'</span> <span class="k">AND</span>
    <span class="o">-&gt;</span> <span class="n">C_CustKey</span> <span class="k">IN</span>
    <span class="o">-&gt;</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">O_CustKey</span>
    <span class="o">-&gt;</span>  <span class="k">FROM</span> <span class="n">ORDERS</span>
    <span class="o">-&gt;</span>  <span class="k">WHERE</span> <span class="k">LOWER</span><span class="p">(</span><span class="n">O_COMMENT</span><span class="p">)</span> <span class="k">LIKE</span> <span class="s1">'%quickly%'</span>
    <span class="o">-&gt;</span> <span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span>                     <span class="mi">62</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="mi">1</span> <span class="k">row</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">80</span> <span class="n">sec</span><span class="p">)</span>

<span class="c1">-- ì²˜ë¦¬ ë°©ë²• ë¹„êµ</span>

<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">EXPLAIN</span>
    <span class="o">-&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span>
    <span class="o">-&gt;</span> <span class="k">FROM</span> <span class="n">CUSTOMER</span> <span class="k">WHERE</span> <span class="n">C_ADDRESS</span> <span class="k">LIKE</span> <span class="s1">'%abc%'</span> <span class="k">AND</span>
    <span class="o">-&gt;</span> <span class="k">EXISTS</span>
    <span class="o">-&gt;</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">O_CustKey</span>
    <span class="o">-&gt;</span>         <span class="k">FROM</span> <span class="n">ORDERS</span>
    <span class="o">-&gt;</span>         <span class="k">WHERE</span> <span class="n">O_custKey</span> <span class="o">=</span> <span class="n">C_CustKey</span> <span class="k">AND</span> <span class="k">LOWER</span><span class="p">(</span><span class="n">O_COMMENT</span><span class="p">)</span> <span class="k">LIKE</span> <span class="s1">'%quickly%'</span>
    <span class="o">-&gt;</span> <span class="p">);</span>
<span class="o">+</span><span class="c1">------+--------------+-------------+--------+---------------+--------------+---------+------+---------+-------------+</span>
<span class="o">|</span> <span class="n">id</span>   <span class="o">|</span> <span class="n">select_type</span>  <span class="o">|</span> <span class="k">table</span>       <span class="o">|</span> <span class="k">type</span>   <span class="o">|</span> <span class="n">possible_keys</span> <span class="o">|</span> <span class="k">key</span>          <span class="o">|</span> <span class="n">key_len</span> <span class="o">|</span> <span class="k">ref</span>  <span class="o">|</span> <span class="k">rows</span>    <span class="o">|</span> <span class="n">Extra</span>       <span class="o">|</span>
<span class="o">+</span><span class="c1">------+--------------+-------------+--------+---------------+--------------+---------+------+---------+-------------+</span>
<span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span> <span class="k">PRIMARY</span>      <span class="o">|</span> <span class="n">CUSTOMER</span>    <span class="o">|</span> <span class="k">ALL</span>    <span class="o">|</span> <span class="k">PRIMARY</span>       <span class="o">|</span> <span class="k">NULL</span>         <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span> <span class="k">NULL</span> <span class="o">|</span>  <span class="mi">147940</span> <span class="o">|</span> <span class="k">Using</span> <span class="k">where</span> <span class="o">|</span>
<span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span> <span class="k">PRIMARY</span>      <span class="o">|</span> <span class="o">&lt;</span><span class="n">subquery2</span><span class="o">&gt;</span> <span class="o">|</span> <span class="n">eq_ref</span> <span class="o">|</span> <span class="n">distinct_key</span>  <span class="o">|</span> <span class="n">distinct_key</span> <span class="o">|</span> <span class="mi">4</span>       <span class="o">|</span> <span class="n">func</span> <span class="o">|</span>       <span class="mi">1</span> <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>    <span class="mi">2</span> <span class="o">|</span> <span class="n">MATERIALIZED</span> <span class="o">|</span> <span class="n">ORDERS</span>      <span class="o">|</span> <span class="k">ALL</span>    <span class="o">|</span> <span class="k">NULL</span>          <span class="o">|</span> <span class="k">NULL</span>         <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span> <span class="k">NULL</span> <span class="o">|</span> <span class="mi">1481240</span> <span class="o">|</span> <span class="k">Using</span> <span class="k">where</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------+--------------+-------------+--------+---------------+--------------+---------+------+---------+-------------+</span>
<span class="mi">3</span> <span class="k">rows</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>

<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span>
<span class="n">MariaDB</span> <span class="p">[</span><span class="n">cose371</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">EXPLAIN</span>
    <span class="o">-&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">C_Name</span><span class="p">)</span>
    <span class="o">-&gt;</span> <span class="k">FROM</span> <span class="n">CUSTOMER</span> <span class="k">WHERE</span> <span class="n">C_ADDRESS</span> <span class="k">LIKE</span> <span class="s1">'%abc%'</span> <span class="k">AND</span>
    <span class="o">-&gt;</span> <span class="n">C_CustKey</span> <span class="k">IN</span>
    <span class="o">-&gt;</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">O_CustKey</span>
    <span class="o">-&gt;</span>  <span class="k">FROM</span> <span class="n">ORDERS</span>
    <span class="o">-&gt;</span>  <span class="k">WHERE</span> <span class="k">LOWER</span><span class="p">(</span><span class="n">O_COMMENT</span><span class="p">)</span> <span class="k">LIKE</span> <span class="s1">'%quickly%'</span>
    <span class="o">-&gt;</span> <span class="p">);</span>
<span class="o">+</span><span class="c1">------+--------------+-------------+--------+---------------+--------------+---------+------+---------+-------------+</span>
<span class="o">|</span> <span class="n">id</span>   <span class="o">|</span> <span class="n">select_type</span>  <span class="o">|</span> <span class="k">table</span>       <span class="o">|</span> <span class="k">type</span>   <span class="o">|</span> <span class="n">possible_keys</span> <span class="o">|</span> <span class="k">key</span>          <span class="o">|</span> <span class="n">key_len</span> <span class="o">|</span> <span class="k">ref</span>  <span class="o">|</span> <span class="k">rows</span>    <span class="o">|</span> <span class="n">Extra</span>       <span class="o">|</span>
<span class="o">+</span><span class="c1">------+--------------+-------------+--------+---------------+--------------+---------+------+---------+-------------+</span>
<span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span> <span class="k">PRIMARY</span>      <span class="o">|</span> <span class="n">CUSTOMER</span>    <span class="o">|</span> <span class="k">ALL</span>    <span class="o">|</span> <span class="k">PRIMARY</span>       <span class="o">|</span> <span class="k">NULL</span>         <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span> <span class="k">NULL</span> <span class="o">|</span>  <span class="mi">147940</span> <span class="o">|</span> <span class="k">Using</span> <span class="k">where</span> <span class="o">|</span>
<span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span> <span class="k">PRIMARY</span>      <span class="o">|</span> <span class="o">&lt;</span><span class="n">subquery2</span><span class="o">&gt;</span> <span class="o">|</span> <span class="n">eq_ref</span> <span class="o">|</span> <span class="n">distinct_key</span>  <span class="o">|</span> <span class="n">distinct_key</span> <span class="o">|</span> <span class="mi">4</span>       <span class="o">|</span> <span class="n">func</span> <span class="o">|</span>       <span class="mi">1</span> <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>    <span class="mi">2</span> <span class="o">|</span> <span class="n">MATERIALIZED</span> <span class="o">|</span> <span class="n">ORDERS</span>      <span class="o">|</span> <span class="k">ALL</span>    <span class="o">|</span> <span class="k">NULL</span>          <span class="o">|</span> <span class="k">NULL</span>         <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span> <span class="k">NULL</span> <span class="o">|</span> <span class="mi">1481240</span> <span class="o">|</span> <span class="k">Using</span> <span class="k">where</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------+--------------+-------------+--------+---------------+--------------+---------+------+---------+-------------+</span>
<span class="mi">3</span> <span class="k">rows</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="6-ì£¼ì˜">6. ì£¼ì˜</h3>

<hr />

<ul>
  <li><strong>ì˜¤í•´í•  ìˆ˜ ìˆëŠ” ì§„ìˆ </strong>: â€˜EXISTS ë³´ë‹¤ INìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ë” ë¹ ë¥´ë‹¤â€™ -&gt; X
    <ul>
      <li>4~5ì—ì„œ ì‚¬ìš©í•œ ì˜ˆì œëŠ” DBMS optimizer ê°œì…ì´ ì—†ë‹¤ë©´ EXISTSê°€ INë³´ë‹¤ ë¹„íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆë˜ ì˜ˆì œì…ë‹ˆë‹¤.</li>
      <li>ê·¸ëŸ¬ë‚˜ INì´ EXISTSë³´ë‹¤ ë¹„íš¨ìœ¨ì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ê²½ìš°ë„ ì¡´ì¬í•©ë‹ˆë‹¤.</li>
    </ul>
  </li>
</ul>
:ET